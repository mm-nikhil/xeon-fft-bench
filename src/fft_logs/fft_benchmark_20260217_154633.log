============================================================
  FFT BENCHMARK RUN
  Date     : Tue Feb 17 15:46:33 IST 2026
  Hostname : amdtoolsserver.morphingmachines
  Log file : ./fft_logs/fft_benchmark_20260217_154633.log
============================================================

[SETUP] Sourcing Intel oneAPI environment if available...

[CHECK] MKL environment:
        MKLROOT     = /home/nikhil/.local
        Include dir = /home/nikhil/.local/include
        Lib dir     = /home/nikhil/.local/lib
        Runtime lib = -l:libmkl_rt.so.2

[CHECK] Compiler availability:
        gcc found: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-22)

[INFO] BENCH_NRUNS=3, BENCH_WARMUP=1
[INFO] KMP_AFFINITY=scatter,granularity=fine
[INFO] OMP_PROC_BIND=spread, OMP_PLACES=cores
[INFO] NOTE: MKL chooses kernels at runtime; ISA is controlled with MKL_ENABLE_INSTRUCTIONS.

------------------------------------------------------------
[COMPILE] Scenario 1 binary: gcc -O2 -std=c99
------------------------------------------------------------
          Binary: fft_cpu_only

------------------------------------------------------------
[COMPILE] Scenario 2/3 binary: gcc -O3 -mavx512f -mavx512dq -mavx512bw -mavx512vl -std=c99
------------------------------------------------------------
          Binary: fft_avx512

============================================================
 RUNNING: Scenario 1 — CPU baseline (single thread)
 Binary : fft_cpu_only
 Threads: 1
 ISA    : SSE4_2
============================================================

OMP: Warning #182: OMP_PLACES: ignored because KMP_AFFINITY has been defined
OMP: Warning #182: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined

########################################################
#         FFT BENCHMARK — Intel MKL DFT                #
#         Random Initialized 3D Complex FFT             #
########################################################
MKL max threads available : 1
Threads requested (cli)   : 1
Timed runs per config     : 3
Warmup runs               : 1 (untimed, stabilize AVX freq)

Column guide:
  Fwd = forward FFT (time + GFLOPS)
  Bwd = inverse FFT (time + GFLOPS)
  Mem = total memory used by in+out buffers

Cache reference (W-2155):
  L1d  32KB  → fits 1D FFT N < 2K complex doubles
  L2    1MB  → fits 3D FFT up to ~40^3
  L3   14MB  → fits 3D FFT up to ~96^3  (64^3 = 4MB  ✓)
  DRAM       → 128^3 = 32MB  (spills L3)   256^3 = 256MB

========================================================================================
  SCENARIO 1 — CPU ONLY (1 thread, scalar baseline)
========================================================================================
  NOTE: Set by compile flag -O2  — no explicit AVX enabled

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    2.088 ms    11.30 GFLOPS | Bwd:    2.024 ms    11.65 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:   10.222 ms     9.23 GFLOPS | Bwd:   10.469 ms     9.01 GFLOPS | Mem:   32.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   25.310 ms     8.70 GFLOPS | Bwd:   25.850 ms     8.52 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:  103.629 ms     8.50 GFLOPS | Bwd:  103.469 ms     8.51 GFLOPS | Mem:  256.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  259.297 ms     7.76 GFLOPS | Bwd:  254.832 ms     7.90 GFLOPS | Mem:  512.0 MB

========================================================================================
  SCENARIO 2 — CPU + AVX-512 (1 thread, vectorized)
========================================================================================
  NOTE: Effective only when compiled with -xCORE-AVX512
        MKL selects AVX-512 kernel automatically

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    2.162 ms    10.91 GFLOPS | Bwd:    2.032 ms    11.61 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:   10.268 ms     9.19 GFLOPS | Bwd:   10.557 ms     8.94 GFLOPS | Mem:   32.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   25.170 ms     8.75 GFLOPS | Bwd:   25.476 ms     8.64 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:  103.377 ms     8.52 GFLOPS | Bwd:  103.928 ms     8.48 GFLOPS | Mem:  256.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  259.400 ms     7.76 GFLOPS | Bwd:  255.515 ms     7.88 GFLOPS | Mem:  512.0 MB

========================================================================================
  SCENARIO 3 — AVX-512 + Multithreaded
========================================================================================
  Threads: 1  (override with: ./fft_benchmark <N>)

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    2.253 ms    10.47 GFLOPS | Bwd:    2.170 ms    10.87 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:   10.346 ms     9.12 GFLOPS | Bwd:   10.782 ms     8.75 GFLOPS | Mem:   32.0 MB
64^3 batch=16          | Grid:   64x  64x  64 | Batch: 16 | Thr: 1 | Fwd:   43.199 ms     8.74 GFLOPS | Bwd:   43.040 ms     8.77 GFLOPS | Mem:  128.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   25.160 ms     8.75 GFLOPS | Bwd:   25.423 ms     8.66 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:  103.507 ms     8.51 GFLOPS | Bwd:  103.952 ms     8.47 GFLOPS | Mem:  256.0 MB
128^3 batch=16         | Grid:  128x 128x 128 | Batch: 16 | Thr: 1 | Fwd:  434.059 ms     8.12 GFLOPS | Bwd:  417.806 ms     8.43 GFLOPS | Mem: 1024.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  260.093 ms     7.74 GFLOPS | Bwd:  256.149 ms     7.86 GFLOPS | Mem:  512.0 MB
256^3 batch=4          | Grid:  256x 256x 256 | Batch:  4 | Thr: 1 | Fwd: 1044.747 ms     7.71 GFLOPS | Bwd: 1029.292 ms     7.82 GFLOPS | Mem: 2048.0 MB

========================================================================================
  SCENARIO 4 — Thread Scaling Sweep (128^3 batch=4)
========================================================================================
  Shows how FFT scales across your 10 physical cores

128^3 thr=1            | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:  103.663 ms     8.50 GFLOPS | Bwd:  103.901 ms     8.48 GFLOPS | Mem:  256.0 MB
128^3 thr=2            | Grid:  128x 128x 128 | Batch:  4 | Thr: 2 | Fwd:   53.074 ms    16.60 GFLOPS | Bwd:   53.394 ms    16.50 GFLOPS | Mem:  256.0 MB
128^3 thr=4            | Grid:  128x 128x 128 | Batch:  4 | Thr: 4 | Fwd:   28.286 ms    31.14 GFLOPS | Bwd:   28.403 ms    31.01 GFLOPS | Mem:  256.0 MB
128^3 thr=8            | Grid:  128x 128x 128 | Batch:  4 | Thr: 8 | Fwd:   16.106 ms    54.69 GFLOPS | Bwd:   16.185 ms    54.42 GFLOPS | Mem:  256.0 MB
128^3 thr=10           | Grid:  128x 128x 128 | Batch:  4 | Thr:10 | Fwd:   14.300 ms    61.60 GFLOPS | Bwd:   14.304 ms    61.58 GFLOPS | Mem:  256.0 MB
128^3 thr=20           | Grid:  128x 128x 128 | Batch:  4 | Thr:20 | Fwd:   13.728 ms    64.16 GFLOPS | Bwd:   13.811 ms    63.77 GFLOPS | Mem:  256.0 MB

========================================================================================
  SCENARIO 5 — Batch Scaling Sweep (128^3, max threads)
========================================================================================
  Shows benefit of batched FFT vs repeated single calls

128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   25.286 ms     8.71 GFLOPS | Bwd:   25.240 ms     8.72 GFLOPS | Mem:   64.0 MB
128^3 batch=2          | Grid:  128x 128x 128 | Batch:  2 | Thr: 1 | Fwd:   50.912 ms     8.65 GFLOPS | Bwd:   51.275 ms     8.59 GFLOPS | Mem:  128.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:  103.446 ms     8.51 GFLOPS | Bwd:  103.049 ms     8.55 GFLOPS | Mem:  256.0 MB
128^3 batch=8          | Grid:  128x 128x 128 | Batch:  8 | Thr: 1 | Fwd:  210.957 ms     8.35 GFLOPS | Bwd:  206.925 ms     8.51 GFLOPS | Mem:  512.0 MB
128^3 batch=16         | Grid:  128x 128x 128 | Batch: 16 | Thr: 1 | Fwd:  428.395 ms     8.22 GFLOPS | Bwd:  416.019 ms     8.47 GFLOPS | Mem: 1024.0 MB
128^3 batch=32         | Grid:  128x 128x 128 | Batch: 32 | Thr: 1 | Fwd:  866.568 ms     8.13 GFLOPS | Bwd:  841.481 ms     8.37 GFLOPS | Mem: 2048.0 MB

########################################################
#                  BENCHMARK COMPLETE                  #
########################################################


real	0m43.862s
user	0m44.520s
sys	0m3.635s

[DONE] Scenario 1 complete

============================================================
 RUNNING: Scenario 2 — AVX-512 (single thread)
 Binary : fft_avx512
 Threads: 1
 ISA    : AVX512
============================================================

OMP: Warning #182: OMP_PLACES: ignored because KMP_AFFINITY has been defined
OMP: Warning #182: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined

########################################################
#         FFT BENCHMARK — Intel MKL DFT                #
#         Random Initialized 3D Complex FFT             #
########################################################
MKL max threads available : 1
Threads requested (cli)   : 1
Timed runs per config     : 3
Warmup runs               : 1 (untimed, stabilize AVX freq)

Column guide:
  Fwd = forward FFT (time + GFLOPS)
  Bwd = inverse FFT (time + GFLOPS)
  Mem = total memory used by in+out buffers

Cache reference (W-2155):
  L1d  32KB  → fits 1D FFT N < 2K complex doubles
  L2    1MB  → fits 3D FFT up to ~40^3
  L3   14MB  → fits 3D FFT up to ~96^3  (64^3 = 4MB  ✓)
  DRAM       → 128^3 = 32MB  (spills L3)   256^3 = 256MB

========================================================================================
  SCENARIO 1 — CPU ONLY (1 thread, scalar baseline)
========================================================================================
  NOTE: Set by compile flag -O2  — no explicit AVX enabled

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    1.195 ms    19.75 GFLOPS | Bwd:    1.172 ms    20.14 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:    6.595 ms    14.31 GFLOPS | Bwd:    6.931 ms    13.62 GFLOPS | Mem:   32.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   16.496 ms    13.35 GFLOPS | Bwd:   16.810 ms    13.10 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   68.709 ms    12.82 GFLOPS | Bwd:   69.970 ms    12.59 GFLOPS | Mem:  256.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  195.272 ms    10.31 GFLOPS | Bwd:  195.034 ms    10.32 GFLOPS | Mem:  512.0 MB

========================================================================================
  SCENARIO 2 — CPU + AVX-512 (1 thread, vectorized)
========================================================================================
  NOTE: Effective only when compiled with -xCORE-AVX512
        MKL selects AVX-512 kernel automatically

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    1.246 ms    18.93 GFLOPS | Bwd:    1.197 ms    19.70 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:    6.747 ms    13.99 GFLOPS | Bwd:    6.957 ms    13.56 GFLOPS | Mem:   32.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   15.975 ms    13.78 GFLOPS | Bwd:   17.040 ms    12.92 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   69.231 ms    12.72 GFLOPS | Bwd:   70.266 ms    12.54 GFLOPS | Mem:  256.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  195.501 ms    10.30 GFLOPS | Bwd:  194.558 ms    10.35 GFLOPS | Mem:  512.0 MB

========================================================================================
  SCENARIO 3 — AVX-512 + Multithreaded
========================================================================================
  Threads: 1  (override with: ./fft_benchmark <N>)

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    1.240 ms    19.03 GFLOPS | Bwd:    1.170 ms    20.17 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:    6.899 ms    13.68 GFLOPS | Bwd:    6.918 ms    13.64 GFLOPS | Mem:   32.0 MB
64^3 batch=16          | Grid:   64x  64x  64 | Batch: 16 | Thr: 1 | Fwd:   29.357 ms    12.86 GFLOPS | Bwd:   30.124 ms    12.53 GFLOPS | Mem:  128.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   16.210 ms    13.58 GFLOPS | Bwd:   17.115 ms    12.87 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   69.040 ms    12.76 GFLOPS | Bwd:   70.363 ms    12.52 GFLOPS | Mem:  256.0 MB
128^3 batch=16         | Grid:  128x 128x 128 | Batch: 16 | Thr: 1 | Fwd:  278.397 ms    12.66 GFLOPS | Bwd:  280.723 ms    12.55 GFLOPS | Mem: 1024.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  241.910 ms     8.32 GFLOPS | Bwd:  248.693 ms     8.10 GFLOPS | Mem:  512.0 MB
256^3 batch=4          | Grid:  256x 256x 256 | Batch:  4 | Thr: 1 | Fwd:  792.241 ms    10.16 GFLOPS | Bwd:  886.468 ms     9.08 GFLOPS | Mem: 2048.0 MB

========================================================================================
  SCENARIO 4 — Thread Scaling Sweep (128^3 batch=4)
========================================================================================
  Shows how FFT scales across your 10 physical cores

128^3 thr=1            | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   84.377 ms    10.44 GFLOPS | Bwd:   86.710 ms    10.16 GFLOPS | Mem:  256.0 MB
128^3 thr=2            | Grid:  128x 128x 128 | Batch:  4 | Thr: 2 | Fwd:   45.346 ms    19.42 GFLOPS | Bwd:   45.780 ms    19.24 GFLOPS | Mem:  256.0 MB
128^3 thr=4            | Grid:  128x 128x 128 | Batch:  4 | Thr: 4 | Fwd:   24.716 ms    35.64 GFLOPS | Bwd:   25.115 ms    35.07 GFLOPS | Mem:  256.0 MB
128^3 thr=8            | Grid:  128x 128x 128 | Batch:  4 | Thr: 8 | Fwd:   18.137 ms    48.56 GFLOPS | Bwd:   18.157 ms    48.51 GFLOPS | Mem:  256.0 MB
128^3 thr=10           | Grid:  128x 128x 128 | Batch:  4 | Thr:10 | Fwd:   14.437 ms    61.01 GFLOPS | Bwd:   14.578 ms    60.42 GFLOPS | Mem:  256.0 MB
128^3 thr=20           | Grid:  128x 128x 128 | Batch:  4 | Thr:20 | Fwd:   14.596 ms    60.34 GFLOPS | Bwd:   14.670 ms    60.04 GFLOPS | Mem:  256.0 MB

========================================================================================
  SCENARIO 5 — Batch Scaling Sweep (128^3, max threads)
========================================================================================
  Shows benefit of batched FFT vs repeated single calls

128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   19.978 ms    11.02 GFLOPS | Bwd:   20.504 ms    10.74 GFLOPS | Mem:   64.0 MB
128^3 batch=2          | Grid:  128x 128x 128 | Batch:  2 | Thr: 1 | Fwd:   42.341 ms    10.40 GFLOPS | Bwd:   41.980 ms    10.49 GFLOPS | Mem:  128.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   84.169 ms    10.46 GFLOPS | Bwd:   85.951 ms    10.25 GFLOPS | Mem:  256.0 MB
128^3 batch=8          | Grid:  128x 128x 128 | Batch:  8 | Thr: 1 | Fwd:  168.314 ms    10.47 GFLOPS | Bwd:  171.683 ms    10.26 GFLOPS | Mem:  512.0 MB
128^3 batch=16         | Grid:  128x 128x 128 | Batch: 16 | Thr: 1 | Fwd:  279.665 ms    12.60 GFLOPS | Bwd:  342.051 ms    10.30 GFLOPS | Mem: 1024.0 MB
128^3 batch=32         | Grid:  128x 128x 128 | Batch: 32 | Thr: 1 | Fwd:  573.114 ms    12.29 GFLOPS | Bwd:  624.287 ms    11.29 GFLOPS | Mem: 2048.0 MB

########################################################
#                  BENCHMARK COMPLETE                  #
########################################################


real	0m34.404s
user	0m36.314s
sys	0m2.472s

[DONE] Scenario 2 complete

============================================================
 RUNNING: Scenario 3 — AVX-512 + physical cores
 Binary : fft_avx512
 Threads: 10
 ISA    : AVX512
============================================================

OMP: Warning #182: OMP_PLACES: ignored because KMP_AFFINITY has been defined
OMP: Warning #182: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined

########################################################
#         FFT BENCHMARK — Intel MKL DFT                #
#         Random Initialized 3D Complex FFT             #
########################################################
MKL max threads available : 10
Threads requested (cli)   : 10
Timed runs per config     : 3
Warmup runs               : 1 (untimed, stabilize AVX freq)

Column guide:
  Fwd = forward FFT (time + GFLOPS)
  Bwd = inverse FFT (time + GFLOPS)
  Mem = total memory used by in+out buffers

Cache reference (W-2155):
  L1d  32KB  → fits 1D FFT N < 2K complex doubles
  L2    1MB  → fits 3D FFT up to ~40^3
  L3   14MB  → fits 3D FFT up to ~96^3  (64^3 = 4MB  ✓)
  DRAM       → 128^3 = 32MB  (spills L3)   256^3 = 256MB

========================================================================================
  SCENARIO 1 — CPU ONLY (1 thread, scalar baseline)
========================================================================================
  NOTE: Set by compile flag -O2  — no explicit AVX enabled

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    1.178 ms    20.03 GFLOPS | Bwd:    1.141 ms    20.67 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:    7.408 ms    12.74 GFLOPS | Bwd:    8.020 ms    11.77 GFLOPS | Mem:   32.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   20.068 ms    10.97 GFLOPS | Bwd:   20.260 ms    10.87 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   83.920 ms    10.50 GFLOPS | Bwd:   86.090 ms    10.23 GFLOPS | Mem:  256.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  225.255 ms     8.94 GFLOPS | Bwd:  231.917 ms     8.68 GFLOPS | Mem:  512.0 MB

========================================================================================
  SCENARIO 2 — CPU + AVX-512 (1 thread, vectorized)
========================================================================================
  NOTE: Effective only when compiled with -xCORE-AVX512
        MKL selects AVX-512 kernel automatically

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    1.132 ms    20.84 GFLOPS | Bwd:    1.125 ms    20.98 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:    7.688 ms    12.27 GFLOPS | Bwd:    7.712 ms    12.24 GFLOPS | Mem:   32.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   20.095 ms    10.96 GFLOPS | Bwd:   20.908 ms    10.53 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   83.879 ms    10.50 GFLOPS | Bwd:   86.032 ms    10.24 GFLOPS | Mem:  256.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  224.801 ms     8.96 GFLOPS | Bwd:  232.062 ms     8.68 GFLOPS | Mem:  512.0 MB

========================================================================================
  SCENARIO 3 — AVX-512 + Multithreaded
========================================================================================
  Threads: 10  (override with: ./fft_benchmark <N>)

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr:10 | Fwd:    0.204 ms   115.84 GFLOPS | Bwd:    0.198 ms   119.26 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr:10 | Fwd:    0.911 ms   103.64 GFLOPS | Bwd:    1.058 ms    89.18 GFLOPS | Mem:   32.0 MB
64^3 batch=16          | Grid:   64x  64x  64 | Batch: 16 | Thr:10 | Fwd:    6.271 ms    60.20 GFLOPS | Bwd:    6.477 ms    58.28 GFLOPS | Mem:  128.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr:10 | Fwd:    3.242 ms    67.92 GFLOPS | Bwd:    3.305 ms    66.64 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr:10 | Fwd:   14.309 ms    61.56 GFLOPS | Bwd:   14.646 ms    60.14 GFLOPS | Mem:  256.0 MB
128^3 batch=16         | Grid:  128x 128x 128 | Batch: 16 | Thr:10 | Fwd:   48.243 ms    73.03 GFLOPS | Bwd:   57.256 ms    61.53 GFLOPS | Mem: 1024.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr:10 | Fwd:   35.024 ms    57.48 GFLOPS | Bwd:   35.600 ms    56.55 GFLOPS | Mem:  512.0 MB
256^3 batch=4          | Grid:  256x 256x 256 | Batch:  4 | Thr:10 | Fwd:  124.693 ms    64.58 GFLOPS | Bwd:  133.064 ms    60.52 GFLOPS | Mem: 2048.0 MB

========================================================================================
  SCENARIO 4 — Thread Scaling Sweep (128^3 batch=4)
========================================================================================
  Shows how FFT scales across your 10 physical cores

128^3 thr=1            | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   84.140 ms    10.47 GFLOPS | Bwd:   88.193 ms     9.99 GFLOPS | Mem:  256.0 MB
128^3 thr=2            | Grid:  128x 128x 128 | Batch:  4 | Thr: 2 | Fwd:   44.902 ms    19.62 GFLOPS | Bwd:   45.401 ms    19.40 GFLOPS | Mem:  256.0 MB
128^3 thr=4            | Grid:  128x 128x 128 | Batch:  4 | Thr: 4 | Fwd:   24.979 ms    35.26 GFLOPS | Bwd:   24.965 ms    35.28 GFLOPS | Mem:  256.0 MB
128^3 thr=8            | Grid:  128x 128x 128 | Batch:  4 | Thr: 8 | Fwd:   17.861 ms    49.31 GFLOPS | Bwd:   18.054 ms    48.79 GFLOPS | Mem:  256.0 MB
128^3 thr=10           | Grid:  128x 128x 128 | Batch:  4 | Thr:10 | Fwd:   14.335 ms    61.44 GFLOPS | Bwd:   14.570 ms    60.45 GFLOPS | Mem:  256.0 MB
128^3 thr=20           | Grid:  128x 128x 128 | Batch:  4 | Thr:20 | Fwd:   15.030 ms    58.60 GFLOPS | Bwd:   14.491 ms    60.78 GFLOPS | Mem:  256.0 MB

========================================================================================
  SCENARIO 5 — Batch Scaling Sweep (128^3, max threads)
========================================================================================
  Shows benefit of batched FFT vs repeated single calls

128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr:10 | Fwd:    3.118 ms    70.63 GFLOPS | Bwd:    3.458 ms    63.68 GFLOPS | Mem:   64.0 MB
128^3 batch=2          | Grid:  128x 128x 128 | Batch:  2 | Thr:10 | Fwd:    7.435 ms    59.23 GFLOPS | Bwd:    7.197 ms    61.19 GFLOPS | Mem:  128.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr:10 | Fwd:   14.332 ms    61.46 GFLOPS | Bwd:   14.397 ms    61.18 GFLOPS | Mem:  256.0 MB
128^3 batch=8          | Grid:  128x 128x 128 | Batch:  8 | Thr:10 | Fwd:   27.850 ms    63.25 GFLOPS | Bwd:   28.257 ms    62.34 GFLOPS | Mem:  512.0 MB
128^3 batch=16         | Grid:  128x 128x 128 | Batch: 16 | Thr:10 | Fwd:   47.368 ms    74.38 GFLOPS | Bwd:   56.240 ms    62.65 GFLOPS | Mem: 1024.0 MB
128^3 batch=32         | Grid:  128x 128x 128 | Batch: 32 | Thr:10 | Fwd:  100.882 ms    69.85 GFLOPS | Bwd:  110.231 ms    63.92 GFLOPS | Mem: 2048.0 MB

########################################################
#                  BENCHMARK COMPLETE                  #
########################################################


real	0m20.140s
user	0m50.161s
sys	0m1.785s

[DONE] Scenario 3 complete

============================================================
 RUNNING: Scenario 3b — AVX-512 + logical cores (hyperthreading)
 Binary : fft_avx512
 Threads: 20
 ISA    : AVX512
============================================================

OMP: Warning #182: OMP_PLACES: ignored because KMP_AFFINITY has been defined
OMP: Warning #182: OMP_PROC_BIND: ignored because KMP_AFFINITY has been defined

########################################################
#         FFT BENCHMARK — Intel MKL DFT                #
#         Random Initialized 3D Complex FFT             #
########################################################
MKL max threads available : 20
Threads requested (cli)   : 20
Timed runs per config     : 3
Warmup runs               : 1 (untimed, stabilize AVX freq)

Column guide:
  Fwd = forward FFT (time + GFLOPS)
  Bwd = inverse FFT (time + GFLOPS)
  Mem = total memory used by in+out buffers

Cache reference (W-2155):
  L1d  32KB  → fits 1D FFT N < 2K complex doubles
  L2    1MB  → fits 3D FFT up to ~40^3
  L3   14MB  → fits 3D FFT up to ~96^3  (64^3 = 4MB  ✓)
  DRAM       → 128^3 = 32MB  (spills L3)   256^3 = 256MB

========================================================================================
  SCENARIO 1 — CPU ONLY (1 thread, scalar baseline)
========================================================================================
  NOTE: Set by compile flag -O2  — no explicit AVX enabled

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    1.241 ms    19.01 GFLOPS | Bwd:    1.198 ms    19.69 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:    7.458 ms    12.65 GFLOPS | Bwd:    7.936 ms    11.89 GFLOPS | Mem:   32.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   20.040 ms    10.99 GFLOPS | Bwd:   20.071 ms    10.97 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   84.610 ms    10.41 GFLOPS | Bwd:   84.927 ms    10.37 GFLOPS | Mem:  256.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  219.282 ms     9.18 GFLOPS | Bwd:  225.056 ms     8.95 GFLOPS | Mem:  512.0 MB

========================================================================================
  SCENARIO 2 — CPU + AVX-512 (1 thread, vectorized)
========================================================================================
  NOTE: Effective only when compiled with -xCORE-AVX512
        MKL selects AVX-512 kernel automatically

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr: 1 | Fwd:    1.161 ms    20.32 GFLOPS | Bwd:    1.146 ms    20.58 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr: 1 | Fwd:    7.349 ms    12.84 GFLOPS | Bwd:    7.719 ms    12.23 GFLOPS | Mem:   32.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr: 1 | Fwd:   20.034 ms    10.99 GFLOPS | Bwd:   20.289 ms    10.85 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   83.545 ms    10.54 GFLOPS | Bwd:   85.285 ms    10.33 GFLOPS | Mem:  256.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr: 1 | Fwd:  218.683 ms     9.21 GFLOPS | Bwd:  224.621 ms     8.96 GFLOPS | Mem:  512.0 MB

========================================================================================
  SCENARIO 3 — AVX-512 + Multithreaded
========================================================================================
  Threads: 20  (override with: ./fft_benchmark <N>)

64^3 batch=1           | Grid:   64x  64x  64 | Batch:  1 | Thr:20 | Fwd:    0.197 ms   120.01 GFLOPS | Bwd:    0.194 ms   121.32 GFLOPS | Mem:    8.0 MB
64^3 batch=4           | Grid:   64x  64x  64 | Batch:  4 | Thr:20 | Fwd:    0.925 ms   102.00 GFLOPS | Bwd:    1.110 ms    85.03 GFLOPS | Mem:   32.0 MB
64^3 batch=16          | Grid:   64x  64x  64 | Batch: 16 | Thr:20 | Fwd:    6.042 ms    62.47 GFLOPS | Bwd:    6.059 ms    62.31 GFLOPS | Mem:  128.0 MB
128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr:20 | Fwd:    3.271 ms    67.32 GFLOPS | Bwd:    3.403 ms    64.71 GFLOPS | Mem:   64.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr:20 | Fwd:   14.281 ms    61.68 GFLOPS | Bwd:   14.622 ms    60.24 GFLOPS | Mem:  256.0 MB
128^3 batch=16         | Grid:  128x 128x 128 | Batch: 16 | Thr:20 | Fwd:   47.857 ms    73.62 GFLOPS | Bwd:   56.435 ms    62.43 GFLOPS | Mem: 1024.0 MB
256^3 batch=1          | Grid:  256x 256x 256 | Batch:  1 | Thr:20 | Fwd:   36.314 ms    55.44 GFLOPS | Bwd:   37.268 ms    54.02 GFLOPS | Mem:  512.0 MB
256^3 batch=4          | Grid:  256x 256x 256 | Batch:  4 | Thr:20 | Fwd:  121.742 ms    66.15 GFLOPS | Bwd:  128.677 ms    62.58 GFLOPS | Mem: 2048.0 MB

========================================================================================
  SCENARIO 4 — Thread Scaling Sweep (128^3 batch=4)
========================================================================================
  Shows how FFT scales across your 10 physical cores

128^3 thr=1            | Grid:  128x 128x 128 | Batch:  4 | Thr: 1 | Fwd:   83.711 ms    10.52 GFLOPS | Bwd:   85.760 ms    10.27 GFLOPS | Mem:  256.0 MB
128^3 thr=2            | Grid:  128x 128x 128 | Batch:  4 | Thr: 2 | Fwd:   45.399 ms    19.40 GFLOPS | Bwd:   46.470 ms    18.95 GFLOPS | Mem:  256.0 MB
128^3 thr=4            | Grid:  128x 128x 128 | Batch:  4 | Thr: 4 | Fwd:   24.425 ms    36.06 GFLOPS | Bwd:   25.879 ms    34.03 GFLOPS | Mem:  256.0 MB
128^3 thr=8            | Grid:  128x 128x 128 | Batch:  4 | Thr: 8 | Fwd:   18.349 ms    48.00 GFLOPS | Bwd:   17.900 ms    49.21 GFLOPS | Mem:  256.0 MB
128^3 thr=10           | Grid:  128x 128x 128 | Batch:  4 | Thr:10 | Fwd:   14.429 ms    61.04 GFLOPS | Bwd:   14.395 ms    61.19 GFLOPS | Mem:  256.0 MB
128^3 thr=20           | Grid:  128x 128x 128 | Batch:  4 | Thr:20 | Fwd:   14.237 ms    61.87 GFLOPS | Bwd:   14.412 ms    61.12 GFLOPS | Mem:  256.0 MB

========================================================================================
  SCENARIO 5 — Batch Scaling Sweep (128^3, max threads)
========================================================================================
  Shows benefit of batched FFT vs repeated single calls

128^3 batch=1          | Grid:  128x 128x 128 | Batch:  1 | Thr:20 | Fwd:    3.366 ms    65.42 GFLOPS | Bwd:    3.369 ms    65.35 GFLOPS | Mem:   64.0 MB
128^3 batch=2          | Grid:  128x 128x 128 | Batch:  2 | Thr:20 | Fwd:    7.145 ms    61.64 GFLOPS | Bwd:    7.317 ms    60.19 GFLOPS | Mem:  128.0 MB
128^3 batch=4          | Grid:  128x 128x 128 | Batch:  4 | Thr:20 | Fwd:   14.419 ms    61.09 GFLOPS | Bwd:   14.661 ms    60.08 GFLOPS | Mem:  256.0 MB
128^3 batch=8          | Grid:  128x 128x 128 | Batch:  8 | Thr:20 | Fwd:   27.534 ms    63.98 GFLOPS | Bwd:   28.433 ms    61.96 GFLOPS | Mem:  512.0 MB
128^3 batch=16         | Grid:  128x 128x 128 | Batch: 16 | Thr:20 | Fwd:   47.842 ms    73.64 GFLOPS | Bwd:   56.229 ms    62.66 GFLOPS | Mem: 1024.0 MB
128^3 batch=32         | Grid:  128x 128x 128 | Batch: 32 | Thr:20 | Fwd:   99.860 ms    70.56 GFLOPS | Bwd:  105.264 ms    66.94 GFLOPS | Mem: 2048.0 MB

########################################################
#                  BENCHMARK COMPLETE                  #
########################################################


real	0m19.960s
user	1m19.855s
sys	0m1.798s

[DONE] Scenario 3b complete

============================================================
 EXTRA: MKL_VERBOSE=1 quick check
============================================================

MKL_VERBOSE oneMKL 2025 Update 3 Product build 20251007 for Intel(R) 64 architecture Intel(R) Advanced Vector Extensions 512 (Intel(R) AVX-512) enabled processors, Lnx 3.30GHz intel_thread
MKL_VERBOSE FFT(dcfi64x64x64,input_strides:{0,4096,64,1},output_strides:{0,4096,64,1},tLim:1,desc:0x920480) 3.59ms CNR:OFF Dyn:0 FastMM:1 TID:0  NThr:1

============================================================
  SUMMARY (128^3 batch=4, Forward GFLOPS)
============================================================
  Scenario 1   : 8.50 GFLOPS
  Scenario 2   : 12.82 GFLOPS  (speedup vs S1: 1.51x)
  Scenario 3   : 61.56 GFLOPS (speedup vs S1: 7.24x)
  Scenario 3b  : 61.68 GFLOPS (speedup vs S1: 7.26x)
============================================================

============================================================
  ALL RUNS COMPLETE
  Log saved to: ./fft_logs/fft_benchmark_20260217_154633.log
  460 lines logged
  Run completed at: Tue Feb 17 15:48:34 IST 2026
============================================================

To inspect full output:
  cat ./fft_logs/fft_benchmark_20260217_154633.log

To extract scenario markers + GFLOPS:
  grep -E 'RUNNING:|SCENARIO|GFLOPS|SUMMARY' ./fft_logs/fft_benchmark_20260217_154633.log
